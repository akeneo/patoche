version: '3'

services:
    php:
        build: './docker/php/'
        image: 'akeneo/patoche/dev:master'
        environment:
            COMPOSER_PROCESS_TIMEOUT: '${SYMFONY_PROCESS_TIMEOUT}'
            PHP_CONF_DISPLAY_ERRORS: 1
            PHP_CONF_DISPLAY_STARTUP_ERRORS: 1
            PHP_CONF_ERROR_REPORTING: 32767
            PHP_CONF_OPCACHE_VALIDATE_TIMESTAMP: 1
            PHP_CONF_ZEND_ASSERTIONS: 1
            PHP_IDE_CONFIG: 'serverName=onboarder-tagging'
            XDEBUG_CONFIG: 'remote_host=172.17.0.1'
            COMPOSER_CACHE_DIR: '/home/composer/.cache/composer'
            COMPOSER_HOME: '/home/composer/.config/composer'
        user: '${CURRENT_IDS:-1000:1000}'
        volumes:
            - './:/srv/app'
            - '~/.cache/composer:/home/composer/.cache/composer'
            - '~/.config/composer:/home/composer/.config/composer'
        working_dir: '/srv/app'
